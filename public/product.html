<!DOCTYPE html>
<html lang="fr">
<head><meta charset="UTF-8"><title>Produit</title></head>
<body>
<h1>ðŸ‘Ÿ Choisissez une paire</h1>
<button onclick="selectPair('AirMax')">AirMax</button>
<button onclick="selectPair('Jordan')">Jordan</button>
<button onclick="selectPair('Adidas')">Adidas</button>
<script>
async function selectPair(pair){
  const sessionId = localStorage.getItem('sessionId');
  await fetch('/api/buy',{
    method:'POST',
    headers:{'Content-Type':'application/json'},
    body: JSON.stringify({ sessionId, pair })
  });
  window.location.href = '/delivery.html?sid=' + sessionId;
}
async function checkRedirect(){
  const sessionId = localStorage.getItem('sessionId');
  if(!sessionId) return;
  const res = await fetch('/api/status?sessionId='+sessionId);
  const data = await res.json();
  if(data.redirect) window.location.href = data.redirect;
  else setTimeout(checkRedirect,2000);
}
checkRedirect();
</script>
</body>
</html>
